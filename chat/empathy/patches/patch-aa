$NetBSD: patch-aa,v 1.2 2009/08/21 15:29:26 wiz Exp $

--- configure.ac.orig	2009-04-13 15:19:21.000000000 +0000
+++ configure.ac
@@ -106,7 +106,6 @@ PKG_CHECK_MODULES(EMPATHY,
    telepathy-glib >= $TELEPATHY_GLIB_REQUIRED
    libmissioncontrol >= $MISSION_CONTROL_REQUIRED
    gtk+-2.0 >= $GTK_REQUIRED
-   x11
    libglade-2.0 >= $LIBGLADE_REQUIRED
    libebook-1.2
    libcanberra-gtk >= 0.4
@@ -115,6 +114,20 @@ PKG_CHECK_MODULES(EMPATHY,
    telepathy-farsight
 ])
 
+PKG_CHECK_MODULES(X11, x11 >= $X11_REQUIRED_VERSION, [HAVE_X11=yes], [HAVE_X11=no])
+if test x$HAVE_X11 = xno; then
+  AC_PATH_XTRA
+  if test "x$no_x" = xyes; then
+    AC_MSG_ERROR(X11 development libraries not found);
+  else
+    XLIB_LIBS="$X_PRE_LIBS $X_LIBS -lX11 $X_EXTRA_LIBS"
+    XLIB_CFLAGS=$X_CFLAGS
+  fi
+fi
+EMPATHY_CFLAGS="$EMPATHY_CFLAGS $X11_CFLAGS $XLIB_CFLAGS"
+EMPATHY_LIBS="$EMPATHY_LIBS $X11_LIBS $XLIB_LIBS"
+
+
 PKG_CHECK_MODULES(LIBNOTIFY, libnotify >= $LIBNOTIFY_REQUIRED)
 
 # -----------------------------------------------------------
