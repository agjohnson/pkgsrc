$NetBSD: patch-af,v 1.5 2009/04/17 17:51:01 drochner Exp $

--- rhythmdb/rhythmdb.c.orig	2009-03-28 19:22:05.000000000 +0100
+++ rhythmdb/rhythmdb.c
@@ -2997,8 +2997,9 @@ rhythmdb_add_to_stat_list (RhythmDB *db,
 	/* do we really need to check for duplicate requests here?  .. nah. */
 	result->uri = rb_refstring_new (uri);
 	db->priv->stat_list = g_list_prepend (db->priv->stat_list, result);
-
+#if 0
 	g_mutex_unlock (db->priv->stat_mutex);
+#endif
 }
 
 
@@ -3052,6 +3053,7 @@ rhythmdb_add_uri_with_types (RhythmDB *d
 
 		entry = rhythmdb_entry_lookup_by_location (db, uri);
 		rhythmdb_add_to_stat_list (db, uri, entry, type, ignore_type, error_type);
+		g_mutex_unlock (db->priv->stat_mutex);
 	}
 }
 
